window.PokedexSearchPanel=Panels.Panel.extend({minWidth:639,maxWidth:639,sidebarWidth:280,search:null,events:{"keyup input.searchbox":"updateSearch","change input.searchbox":"updateSearch","search input.searchbox":"updateSearch",submit:"submit",keydown:"keydown",keyup:"keyup",click:"click","click .result a":"clickResult","click .filter":"removeFilter","mouseover .result a":"hoverlink"},activeLink:null,initialize:function(){var e=this.fragment.slice(Config.baseurl.length-1),t=e.indexOf("?");"moves"===e&&(e="moves/"),"pokemon"===e&&(e="pokemon/"),t>=0&&(e=e.slice(0,t));var s='<div class="pfx-body"><form class="pokedex">';s+='<h1><a href="'+Config.baseurl+'"" data-target="replace">Pok&eacute;dex</a></h1>'+('<ul class="tabbar centered" style="margin-bottom: 18px"><li><button class="button nav-first'+(""===e?" cur":"")+'" value="')+Config.baseurl+'">Search</button></li>'+('<li><button class="button'+("pokemon/"===e?" cur":"")+'" value="')+Config.baseurl+'pokemon/">Pok&eacute;mon</button></li>'+('<li><button class="button nav-last'+("moves/"===e?" cur":"")+'" value="')+Config.baseurl+'moves/">Moves</button></li></ul><div class="searchboxwrapper"><input class="textbox searchbox" type="search" name="q" value="'+escapeHTML(this.$(".searchbox").val()||"")+'" autocomplete="off" autofocus placeholder="Search Pok&eacute;mon, moves, abilities, items, types, or more" /></div>',""===e&&(s+='<p class="buttonbar"><button class="button"><strong>Pok&eacute;dex Search</strong></button> <button name="lucky" class="button">I\'m Feeling Lucky</button></p>'),s+='</form><div class="results"></div></div>',this.$el.html(s);var a=this.$(".searchbox");this.$searchbox=a,this.$searchfilters=null;var i=this.$(".results");if(i.length){var r=this.search=new BattleSearch(i,this.$el);this.$el.on("scroll",function(){r.updateScroll()}),"pokemon/"===e?(r.setType("pokemon"),a.attr("placeholder","Search pokemon OR filter by type, move, ability, egg group"),this.$(".buttonbar").remove()):"moves/"===e&&(r.setType("move"),a.attr("placeholder","Search moves OR filter by type, category, pokemon"),this.$(".buttonbar").remove()),this.search.externalFilter=!0}else this.search=null;a.focus(),this.find(a.val()),this.checkExactMatch()},updateSearch:function(e){this.find(e.currentTarget.value)},removeFilter:function(e){this.search.removeFilter(e),this.updateFilters(),this.$searchbox.focus()},updateFilters:function(){// this.search.externalFilter = true;
var e="";if("pokemon"===this.search.qType)e='<button class="filter noclear" value=":">Pok\xe9mon</button> ';else if("move"===this.search.qType)e='<button class="filter noclear" value=":">Moves</button> ';else{this.$(".searchbox-filters").remove(),this.$searchbox.css("padding","2px");return}if(this.search.filters)for(var t=0;t<this.search.filters.length;t++){var s=this.search.filters[t],a=s[1];"move"===s[0]&&(a=getID(BattleMovedex,a).name),"pokemon"===s[0]&&(a=getID(BattlePokedex,a).name),e+='<button class="filter" value="'+escapeHTML(s.join(":"))+'">'+a+' <i class="fa fa-times-circle"></i></button> '}this.$searchfilters||(this.$searchfilters=$('<div class="searchbox-filters"></div>').insertAfter(this.$searchbox)),this.$searchfilters.html(e);var i=this.$searchfilters.width();i>this.$searchbox.outerWidth()/2?this.$searchbox.css("padding",""+(this.$searchfilters.height()+4)+"px 2px 2px 2px"):this.$searchbox.css("padding","2px 2px 2px "+(i+6)+"px")},submit:function(e){e.preventDefault(),this.$(".searchbox").attr("placeholder","Type in: Pokemon, move, item, ability...").focus()},keyup:function(e){var t=this.$searchbox.val(),s=toID(t);if(s){var a=t.charAt(t.length-1);if(","===a||" "===a){if("ds"===s||"dexsearch"===s||"pokemon"===s){this.app.go("pokemon/",this,!0);return}if("ms"===s||"movesearch"===s||"move"===s||"moves"===s){this.app.go("moves/",this,!0);return}}if(","===a&&this.search.addFilter(this.activeLink)){this.$searchbox.val(""),this.find("");return}}},keydown:function(e){switch(e.keyCode){case 13:if(e.preventDefault(),e.stopPropagation(),this.search.addFilter(this.activeLink)){this.$searchbox.val(""),this.find("");return}if(this.activeLink){var t=this.activeLink.pathname.substr(1);if("moves/"===t||"pokemon/"===t){this.app.go(t,this,!0);return}this.app.go(t,this,!1,$(this.activeLink))}else this.$searchbox.val()||this.app.slicePanel(this);break;case 188:if(this.search.addFilter(this.activeLink)){e.preventDefault(),e.stopPropagation(),this.$searchbox.val(""),this.find("");return}break;case 32:var s=toID(this.$searchbox.val());if("ds"===s||"pokemon"===s){e.preventDefault(),e.stopPropagation(),this.app.go("pokemon/",this,!0);return}if("ms"===s||"move"===s||"moves"===s){e.preventDefault(),e.stopPropagation(),this.app.go("moves/",this,!0);return}break;case 38:e.preventDefault(),e.stopPropagation();for(var a=$(this.activeLink).parent().prev();a[0]&&"A"!==a[0].firstChild.tagName;)a=a.prev();a[0]&&a.children()[0]&&($(this.activeLink).removeClass("active"),this.activeLink=a.children()[0],$(this.activeLink).addClass("active"));break;case 40:e.preventDefault(),e.stopPropagation();for(var a=$(this.activeLink).parent().next();a[0]&&"A"!==a[0].firstChild.tagName;)a=a.next();a[0]&&a.children()[0]&&($(this.activeLink).removeClass("active"),this.activeLink=a.children()[0],$(this.activeLink).addClass("active"));break;case 27:case 8:if(this.$searchbox.val())break;if(this.search.removeFilter()){this.find("");return}if(this.search.qType){this.app.go("",this,!0);return}this.app.panels.length>1&&(e.preventDefault(),e.stopPropagation(),this.app.slicePanel(this))}},click:function(e){if("BUTTON"===e.target.tagName&&$(e.target).closest(".tabbar").length){e.preventDefault(),e.stopPropagation(),this.app.go(e.target.value,this,!0);return}if("BUTTON"===e.target.tagName&&"lucky"===e.target.name){e.preventDefault(),e.stopPropagation(),alert(["That's pretty cool.","Your mom's feeling lucky.","I see.","If you feel lucky for more than four hours, perhaps you should see a doctor."][Math.floor(4*Math.random())]);return}var t=this.$el.scrollTop();this.$searchbox.focus(),this.$el.scrollTop(t)},clickResult:function(e){if(this.search.addFilter(e.currentTarget)){e.preventDefault(),e.stopImmediatePropagation(),this.$searchbox.val(""),this.find("");return}},hoverlink:function(e){$(this.activeLink).removeClass("active"),this.activeLink=e.currentTarget,$(this.activeLink).addClass("active")},find:function(e){this.search&&(e||(e=""),this.updateFilters(),this.search.find(e)&&(this.search.q||this.search.filters?(this.$(".pokedex").addClass("aboveresults"),this.activeLink=this.search.el.getElementsByTagName("a")[0],$(this.activeLink).addClass("active")):(this.$(".pokedex").removeClass("aboveresults"),this.activeLink=null)))},checkExactMatch:function(){this.search&&this.search.exactMatch&&"metronome"!==this.search.q&&"psychic"!==this.search.q&&setTimeout((function(){this.app.go($(this.activeLink).attr("href"),this,!1,$(this.activeLink),!0)}).bind(this))}});//# sourceMappingURL=index.b1cdec65.js.map

//# sourceMappingURL=index.b1cdec65.js.map
