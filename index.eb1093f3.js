!/**
 * Search
 *
 * Basically just an improved version of utilichart
 *
 * Dependencies: jQuery, battledata, search-index
 * Optional dependencies: pokedex, moves, items, abilities
 *
 * @author Guangcong Luo <guangcongluo@gmail.com>
 */function(t,e){function s(t,s){this.$el=e(t),this.el=this.$el[0],this.$viewport=s?e(s):e(window),this.urlRoot="",this.q=void 0,this.exactMatch=!1,this.resultSet=null,this.filters=null,this.sortCol=null,this.renderedIndex=0,this.renderingDone=!0,this.externalFilter=!1,this.cur={},this.$inputEl=null,this.gen=9,this.mod=null,this.engine=new DexSearch,window.search=this;var a=this;this.$el.on("click",".more button",function(t){t.preventDefault(),a.updateScroll(!0)}),this.$el.on("click",".filter",function(t){t.preventDefault(),a.removeFilter(t),a.$inputEl&&a.$inputEl.focus()}),this.$el.on("click",".sortcol",function(t){t.preventDefault(),t.stopPropagation();var e=t.currentTarget.dataset.sort;a.engine.toggleSort(e),a.sortCol=a.engine.sortCol,a.find("")})}s.prototype.$=function(t){return this.$el.find(t)},//
// Search functions
//
s.prototype.find=function(t,e){if(this.engine.find(t)){if(this.exactMatch=this.engine.exactMatch,this.q=this.engine.query,this.resultSet=this.engine.results,e&&(this.resultSet=[[this.engine.typedSearch.searchType,e]].concat(this.resultSet),this.resultSet.length>1&&["sortpokemon","sortmove"].includes(this.resultSet[1][0]))){var s=this.resultSet[1];this.resultSet[1]=this.resultSet[0],this.resultSet[0]=s}return this.filters&&(this.resultSet=[["html",this.getFilterText()]].concat(this.resultSet)),this.renderedIndex=0,this.renderingDone=!1,this.updateScroll(),!0}// nothing changed
},s.prototype.addFilter=function(t){if(!t.dataset.entry)return!1;var e=t.dataset.entry.split("|"),s=this.engine.addFilter(e);return this.filters=this.engine.filters,s},s.prototype.removeFilter=function(t){var e;return e=t?this.engine.removeFilter(t.currentTarget.value.split(":")):this.engine.removeFilter(),this.filters=this.engine.filters,this.find(""),e},s.prototype.getFilterText=function(t){for(var e="<p>Filters: ",s=0;s<this.filters.length;s++){var a=this.filters[s][1];"move"===this.filters[s][0]&&(a=getID(BattleMovedex,a).name),"pokemon"===this.filters[s][0]&&(a=getID(BattlePokedex,a).name),e+='<button class="filter" value="'+escapeHTML(this.filters[s].join(":"))+'">'+a+' <i class="fa fa-times-circle"></i></button> '}return t||(e+='<small style="color: #888">(backspace = delete filter)</small>'),e+"</p>"},s.prototype.updateScroll=function(t){if(!this.renderingDone){var s=this.$viewport.scrollTop(),a=s+this.$viewport.height(),r=e(window).height(),o=this.renderedIndex,l=Math.floor(a/33)+1;if(t||!(l<=o)){l<o+20&&(l=o+20),a-s>r&&!o&&(l=20),t&&l>o+40&&(l=o+40);for(var n=this.resultSet,c="";o<l;){if(!n[o]){this.renderingDone=!0;break}var i,p=n[o],u="";(i=this.engine.filterLabel(p[0]))?u='<span class="col filtercol"><em>'+i+"</em></span>":(i=this.engine.illegalLabel(p[1]))&&(u='<span class="col illegalcol"><em>'+i+"</em></span>");var m=0,b=0;p.length>3&&(m=p[2],b=p[3]),c+=this.renderRow(p[1],p[0],m,b,u,p[1]in this.cur?' class="cur"':""),o++}this.renderedIndex?(this.moreVisible&&(this.$el.find(".more").remove(),t||(this.moreVisible=!1)),e(this.el.firstChild).append(c+(t&&!this.renderingDone?'<li class="result more"><p><button class="button big">More</button></p></li>':""))):(this.el.innerHTML='<ul class="utilichart" style="height:'+33*n.length+'px">'+c+(this.renderingDone?"":'<li class="result more"><p><button class="button big">More</button></p></li>')+"</ul>",this.moreVisible=!0),this.renderedIndex=o}}},s.prototype.setType=function(t,e,s,a){var r;for(var o in this.engine.setType(t,e,s),this.filters=this.engine.filters,this.sortCol=this.engine.sortCol,this.cur=a||{},a){r=o;break}this.find("",r)},/*********************************************************
	 * Rendering functions
	 *********************************************************/// These all have static versions
s.prototype.renderRow=function(t,e,s,a,r,o){// errorMessage = '<span class="col illegalcol"><em>' + errorMessage + '</em></span>';
switch(e){case"html":return'<li class="result">'+t+"</li>";case"header":return'<li class="result"><h3>'+t+"</h3></li>";case"sortpokemon":return this.renderPokemonSortRow();case"sortmove":return this.renderMoveSortRow();case"pokemon":var l=getID(BattlePokedex,t);return this.renderPokemonRow(l,s,a,r,o);case"move":var n=getID(BattleMovedex,t);return this.renderMoveRow(n,s,a,r,o);case"item":var c=getID(BattleItems,t);return this.renderItemRow(c,s,a,r,o);case"ability":var i=getID(BattleAbilities,t);return this.renderAbilityRow(i,s,a,r,o);case"type":var e={name:t[0].toUpperCase()+t.substr(1)};return this.renderTypeRow(e,s,a,r);case"egggroup":"humanlike"===t?p="Human-Like":"water1"===t?p="Water 1":"water2"===t?p="Water 2":"water3"===t&&(p="Water 3"),p?a>5&&a++:p=t[0].toUpperCase()+t.substr(1);var p,u={name:p};return this.renderEggGroupRow(u,s,a,r);case"tier":return this.renderTierRow({name:{uber:"Uber",ou:"OU",uu:"UU",ru:"RU",nu:"NU",pu:"PU",zu:"(PU)",nfe:"NFE",lc:"LC",cap:"CAP",caplc:"CAP LC",capnfe:"CAP NFE",uubl:"UUBL",rubl:"RUBL",nubl:"NUBL",publ:"PUBL"}[t]},s,a,r);case"category":var m={name:t[0].toUpperCase()+t.substr(1),id:t};return this.renderCategoryRow(m,s,a,r);case"article":var b=window.BattleArticleTitles&&BattleArticleTitles[t]||t[0].toUpperCase()+t.substr(1);return this.renderArticleRow({name:b,id:t},s,a,r)}return"Error: not found"},s.prototype.renderPokemonSortRow=function(){return'<li class="result"><div class="sortrow">'+('<button class="sortcol numsortcol'+(this.sortCol?"":" cur")+'">'+(this.sortCol?this.engine.firstPokemonColumn:"Sort: ")+'</button><button class="sortcol pnamesortcol'+("name"===this.sortCol?" cur":"")+'" data-sort="name">Name</button><button class="sortcol typesortcol'+("type"===this.sortCol?" cur":"")+'" data-sort="type">Types</button><button class="sortcol abilitysortcol'+("ability"===this.sortCol?" cur":"")+'" data-sort="ability">Abilities</button><button class="sortcol statsortcol'+("hp"===this.sortCol?" cur":"")+'" data-sort="hp">HP</button><button class="sortcol statsortcol'+("atk"===this.sortCol?" cur":"")+'" data-sort="atk">Atk</button><button class="sortcol statsortcol'+("def"===this.sortCol?" cur":"")+'" data-sort="def">Def</button><button class="sortcol statsortcol'+("spa"===this.sortCol?" cur":"")+'" data-sort="spa">SpA</button><button class="sortcol statsortcol'+("spd"===this.sortCol?" cur":"")+'" data-sort="spd">SpD</button><button class="sortcol statsortcol'+("spe"===this.sortCol?" cur":"")+'" data-sort="spe">Spe</button><button class="sortcol statsortcol'+("bst"===this.sortCol?" cur":""))+'" data-sort="bst">BST</button></div></li>'},s.prototype.renderMoveSortRow=function(){return'<li class="result"><div class="sortrow">'+('<button class="sortcol movenamesortcol'+("name"===this.sortCol?" cur":"")+'" data-sort="name">Name</button><button class="sortcol movetypesortcol'+("type"===this.sortCol?" cur":"")+'" data-sort="type">Type</button><button class="sortcol movetypesortcol'+("category"===this.sortCol?" cur":"")+'" data-sort="category">Cat</button><button class="sortcol powersortcol'+("power"===this.sortCol?" cur":"")+'" data-sort="power">Pow</button><button class="sortcol accuracysortcol'+("accuracy"===this.sortCol?" cur":"")+'" data-sort="accuracy">Acc</button><button class="sortcol ppsortcol'+("pp"===this.sortCol?" cur":""))+'" data-sort="pp">PP</button></div></li>'},s.prototype.renderPokemonRow=function(t,e,a,r,o){if(o||(o=""),!t)return'<li class="result">Unrecognized pokemon</li>';var l=toID(t.name);s.urlRoot&&(o+=' href="'+s.urlRoot+"pokemon/"+l+'" data-target="push"');var n='<li class="result"><a'+o+' data-entry="pokemon|'+escapeHTML(t.name)+'">';n+='<span class="col numcol">'+t.num+'</span> <span class="col iconcol"><span style="'+getPokemonIcon(t.name)+'"></span></span> ';// name
var c=t.name,i=t.forme?c.length-t.forme.length-1:0;// error
if(i&&(c=c.substr(0,i)),a&&(c=c.substr(0,e)+"<b>"+c.substr(e,a)+"</b>"+c.substr(e+a)),i&&(a&&e+a>i?(e<i&&(a-=i-e,e=i),c+="<small>"+t.name.substr(i,e-i)+"<b>"+t.name.substr(e,a)+"</b>"+t.name.substr(e+a)+"</small>"):c+="<small>"+t.name.substr(i)+"</small>"),n+='<span class="col pokemonnamecol">'+c+"</span> ",r)return n+(r+"</a></li>");// type
n+='<span class="col typecol">';for(var p=t.types,u=0;u<p.length;u++)n+=getTypeIcon(p[u]);n+="</span> ";var m=t.abilities;m["1"]?n+='<span class="col twoabilitycol">'+m["0"]+"<br />"+m["1"]+"</span>":n+='<span class="col abilitycol">'+m["0"]+"</span>",m.S?m.H?n+='<span class="col twoabilitycol">'+(m.H||"")+"<br />("+m.S+")</span>":n+='<span class="col abilitycol">('+m.S+")</span>":m.H?n+='<span class="col abilitycol">'+m.H+"</span>":n+='<span class="col abilitycol"></span>';// base stats
var b=t.baseStats;n+='<span class="col statcol"><em>HP</em><br />'+b.hp+'</span> <span class="col statcol"><em>Atk</em><br />'+b.atk+'</span> <span class="col statcol"><em>Def</em><br />'+b.def+'</span> <span class="col statcol"><em>SpA</em><br />'+b.spa+'</span> <span class="col statcol"><em>SpD</em><br />'+b.spd+'</span> <span class="col statcol"><em>Spe</em><br />'+b.spe+"</span> ";var d=0;for(u in b)d+=b[u];return n+('<span class="col bstcol"><em>BST<br />'+d)+"</em></span> </a></li>"},s.prototype.renderTaggedPokemonRowInner=function(t,e,a){var r="";s.urlRoot&&(r=' href="'+s.urlRoot+"pokemon/"+toID(t.name)+'" data-target="push"');var o="<a"+r+' data-entry="pokemon|'+escapeHTML(t.name)+'">';o+='<span class="col tagcol shorttagcol">'+e+'</span> <span class="col iconcol"><span style="'+getPokemonIcon(t.name)+'"></span></span> ';// name
var l=t.name,n=t.forme?l.length-t.forme.length-1:0;// error
if(n&&(l=l.substr(0,n)+"<small>"+t.name.substr(n)+"</small>"),o+='<span class="col shortpokemonnamecol">'+l+"</span> ",a)return o+(a+"</a></li>");// type
o+='<span class="col typecol">';for(var c=0;c<t.types.length;c++)o+=getTypeIcon(t.types[c]);for(var c in // abilities
o+='</span> <span style="float:left;min-height:26px">',t.abilities["1"]?o+='<span class="col twoabilitycol">':o+='<span class="col abilitycol">',t.abilities){var i=t.abilities[c];i&&("1"===c&&(o+="<br />"),"H"===c&&(i='</span><span class="col abilitycol"><em>'+t.abilities[c]+"</em>"),o+=i)}t.abilities.H||(o+='</span><span class="col abilitycol">'),o+='</span></span><span style="float:left;min-height:26px"><span class="col statcol"><em>HP</em><br />'+t.baseStats.hp+'</span> <span class="col statcol"><em>Atk</em><br />'+t.baseStats.atk+'</span> <span class="col statcol"><em>Def</em><br />'+t.baseStats.def+'</span> <span class="col statcol"><em>SpA</em><br />'+t.baseStats.spa+'</span> <span class="col statcol"><em>SpD</em><br />'+t.baseStats.spd+'</span> <span class="col statcol"><em>Spe</em><br />'+t.baseStats.spe+"</span> ";var p=0;for(c in t.baseStats)p+=t.baseStats[c];return o+('<span class="col bstcol"><em>BST<br />'+p)+"</em></span> </span></a>"},s.prototype.renderItemRow=function(t,e,a,r,o){if(o||(o=""),!t)return'<li class="result">Unrecognized item</li>';var l=toID(t.name);s.urlRoot&&(o+=' href="'+s.urlRoot+"items/"+l+'" data-target="push"');var n='<li class="result"><a'+o+' data-entry="item|'+escapeHTML(t.name)+'">';n+='<span class="col itemiconcol"><span style="'+getItemIcon(t)+'"></span></span> ';// name
var c=t.name;return(// error
(a&&(c=c.substr(0,e)+"<b>"+c.substr(e,a)+"</b>"+c.substr(e+a)),n+='<span class="col namecol">'+c+"</span> ",r)?n+=r+"</a></li>":n+='<span class="col itemdesccol">'+escapeHTML(t.shortDesc)+"</span> </a></li>")},s.prototype.renderAbilityRow=function(t,e,a,r,o){if(o||(o=""),!t)return'<li class="result">Unrecognized ability</li>';var l=toID(t.name);s.urlRoot&&(o+=' href="'+s.urlRoot+"abilities/"+l+'" data-target="push"');var n='<li class="result"><a'+o+' data-entry="ability|'+escapeHTML(t.name)+'">',c=t.name;return(// error
(a&&(c=c.substr(0,e)+"<b>"+c.substr(e,a)+"</b>"+c.substr(e+a)),n+='<span class="col namecol">'+c+"</span> ",r)?n+=r+"</a></li>":n+='<span class="col abilitydesccol">'+escapeHTML(t.shortDesc)+"</span> </a></li>")},s.prototype.renderMoveRow=function(t,e,a,r,o){if(o||(o=""),!t)return'<li class="result">Unrecognized move</li>';var l=toID(t.name);s.urlRoot&&(o+=' href="'+s.urlRoot+"moves/"+l+'" data-target="push"');var n='<li class="result"><a'+o+' data-entry="move|'+escapeHTML(t.name)+'">',c=t.name,i="Hidden Power"===c.substr(0,12)?12:0;// error
if(i&&(c=c.substr(0,i)),a&&(c=c.substr(0,e)+"<b>"+c.substr(e,a)+"</b>"+c.substr(e+a)),i&&(a&&e+a>i?(e<i&&(a-=i-e,e=i),c+="<small>"+t.name.substr(i,e-i)+"<b>"+t.name.substr(e,a)+"</b>"+t.name.substr(e+a)+"</small>"):c+="<small>"+t.name.substr(i)+"</small>"),n+='<span class="col movenamecol">'+c+"</span> ",r)return n+(r+"</a></li>");n+='<span class="col typecol">'+getTypeIcon(t.type)+getCategoryIcon(t.category)+"</span> ";// power, accuracy, pp
var p=Math.floor(1===t.pp||t.noPPBoosts?t.pp:8*t.pp/5);return n+('<span class="col labelcol">'+("Status"!==t.category?"<em>Power</em><br />"+(t.basePower||"&mdash;"):"")+'</span> <span class="col widelabelcol"><em>Accuracy</em><br />'+(t.accuracy&&!0!==t.accuracy?t.accuracy+"%":"&mdash;")+'</span> <span class="col pplabelcol"><em>PP</em><br />'+p+'</span> <span class="col movedesccol">'+escapeHTML(t.shortDesc))+"</span> </a></li>"},s.prototype.renderMoveRowInner=function(t,e){var a="";s.urlRoot&&(a=' href="'+s.urlRoot+"moves/"+toID(t.name)+'" data-target="push"');var r="<a"+a+' data-entry="move|'+escapeHTML(t.name)+'">',o=t.name,l="Hidden Power"===o.substr(0,12)?12:0;// error
if(l&&(o=o.substr(0,l)+"<small>"+t.name.substr(l)+"</small>"),r+='<span class="col movenamecol">'+o+"</span> ",e)return r+(e+"</a></li>");r+='<span class="col typecol">'+getTypeIcon(t.type)+getCategoryIcon(t.category)+"</span> ";// power, accuracy, pp
var n=1===t.pp||t.noPPBoosts?t.pp:8*t.pp/5;return r+('<span class="col labelcol">'+("Status"!==t.category?"<em>Power</em><br />"+(t.basePower||"&mdash;"):"")+'</span> <span class="col widelabelcol"><em>Accuracy</em><br />'+(t.accuracy&&!0!==t.accuracy?t.accuracy+"%":"&mdash;")+'</span> <span class="col pplabelcol"><em>PP</em><br />'+n+'</span> <span class="col movedesccol">'+escapeHTML(t.shortDesc||t.desc))+"</span> </a>"},s.prototype.renderTaggedMoveRow=function(t,e,a){var r="";s.urlRoot&&(r=' href="'+s.urlRoot+"moves/"+toID(t.name)+'" data-target="push"');var o='<li class="result"><a'+r+' data-entry="move|'+escapeHTML(t.name)+'">';// tag
o+='<span class="col tagcol">'+e+"</span> ";// name
var l=t.name;return(// error
("Hidden Power"===l.substr(0,12)&&(l="Hidden Power"),o+='<span class="col shortmovenamecol">'+l+"</span> ",a)?o+=a+"</a></li>":o+='<span class="col typecol">'+getTypeIcon(t.type)+getCategoryIcon(t.category)+'</span> <span class="col labelcol">'+("Status"!==t.category?"<em>Power</em><br />"+(t.basePower||"&mdash;"):"")+'</span> <span class="col widelabelcol"><em>Accuracy</em><br />'+(t.accuracy&&!0!==t.accuracy?t.accuracy+"%":"&mdash;")+'</span> <span class="col pplabelcol"><em>PP</em><br />'+(t.noPPBoosts?t.pp:8*t.pp/5)+'</span> <span class="col movedesccol">'+escapeHTML(t.shortDesc||t.desc)+"</span> </a></li>")},s.prototype.renderTypeRow=function(t,e,a,r){var o="";s.urlRoot&&(o=' href="'+s.urlRoot+"types/"+toID(t.name)+'" data-target="push"');var l='<li class="result"><a'+o+' data-entry="type|'+escapeHTML(t.name)+'">',n=t.name;return(// error
(a&&(n=n.substr(0,e)+"<b>"+n.substr(e,a)+"</b>"+n.substr(e+a)),l+='<span class="col namecol">'+n+'</span> <span class="col typecol">'+getTypeIcon(t.name)+"</span> ",r)?l+=r+"</a></li>":l+="</a></li>")},s.prototype.renderCategoryRow=function(t,e,a,r){var o="";s.urlRoot&&(o=' href="'+s.urlRoot+"categories/"+t.id+'" data-target="push"');var l='<li class="result"><a'+o+' data-entry="category|'+escapeHTML(t.name)+'">',n=t.name;return(// error
(a&&(n=n.substr(0,e)+"<b>"+n.substr(e,a)+"</b>"+n.substr(e+a)),// category
l+='<span class="col namecol">'+n+'</span> <span class="col typecol">'+getCategoryIcon(t.name)+"</span> ",r)?l+=r+"</a></li>":l+="</a></li>")},s.prototype.renderArticleRow=function(t,e,a,r){var o="";s.urlRoot&&(o=' href="'+s.urlRoot+"articles/"+t.id+'" data-target="push"');var l="pokemon"===t.id||"moves"===t.id;l&&(o=' href="'+t.id+'/" data-target="replace"');var n='<li class="result"><a'+o+' data-entry="article|'+escapeHTML(t.name)+'">',c=t.name;return(// error
(a&&(c=c.substr(0,e)+"<b>"+c.substr(e,a)+"</b>"+c.substr(e+a)),n+='<span class="col namecol">'+c+"</span> ",l?n+='<span class="col movedesccol">(search type)</span> ':n+='<span class="col movedesccol">(article)</span> ',r)?n+=r+"</a></li>":n+="</a></li>")},s.prototype.renderEggGroupRow=function(t,e,a,r){var o="";s.urlRoot&&(o=' href="'+s.urlRoot+"egggroups/"+toID(t.name)+'" data-target="push"');var l='<li class="result"><a'+o+' data-entry="egggroup|'+escapeHTML(t.name)+'">',n=t.name;return(// error
(a&&(n=n.substr(0,e)+"<b>"+n.substr(e,a)+"</b>"+n.substr(e+a)),l+='<span class="col namecol">'+n+"</span> ",r)?l+=r+"</a></li>":l+="</a></li>")},s.prototype.renderTierRow=function(t,e,a,r){var o="";s.urlRoot&&(o=' href="'+s.urlRoot+"tiers/"+toID(t.name)+'" data-target="push"');var l='<li class="result"><a'+o+' data-entry="tier|'+escapeHTML(t.name)+'">',n=t.name;return(// error
(a&&(n=n.substr(0,e)+"<b>"+n.substr(e,a)+"</b>"+n.substr(e+a)),l+='<span class="col namecol">'+n+"</span> ",r)?l+=r+"</a></li>":l+="</a></li>")},s.gen=9,s.renderRow=s.prototype.renderRow,s.renderPokemonRow=s.prototype.renderPokemonRow,s.renderTaggedPokemonRowInner=s.prototype.renderTaggedPokemonRowInner,s.renderItemRow=s.prototype.renderItemRow,s.renderAbilityRow=s.prototype.renderAbilityRow,s.renderMoveRow=s.prototype.renderMoveRow,s.renderMoveRowInner=s.prototype.renderMoveRowInner,s.renderTaggedMoveRow=s.prototype.renderTaggedMoveRow,s.renderTypeRow=s.prototype.renderTypeRow,s.renderCategoryRow=s.prototype.renderCategoryRow,s.renderEggGroupRow=s.prototype.renderEggGroupRow,s.renderTierRow=s.prototype.renderTierRow,t.BattleSearch=s}(window,jQuery);//# sourceMappingURL=index.eb1093f3.js.map

//# sourceMappingURL=index.eb1093f3.js.map
